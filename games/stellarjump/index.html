<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stellar Jump - IAmDrCat.com</title>
  <meta name="description" content="Jump through the cosmos! An endless platformer game by IAmDrCat." />

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5658369692346701"
    crossorigin="anonymous"></script>

  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://iamdrcat.com/games/stellarjump/" />
  <meta property="og:title" content="Stellar Jump - IAmDrCat.com" />
  <meta property="og:description" content="Jump through the cosmos! An endless platformer game." />
  <meta property="og:image" content="https://iamdrcat.com/pop_drcat.gif" />

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, #0a0a1a, #0f3460);
      color: #fff;
      overflow-x: hidden;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }

    /* Header/Nav - Site Common */
    header {
      width: 100%;
      position: relative;
      z-index: 100;
      padding: 20px;
      background: rgba(0, 0, 0, 0.4);
      margin-bottom: 40px;
    }

    nav {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
    }

    .logo {
      font-size: clamp(1.2rem, 4vw, 1.5rem);
      font-weight: bold;
      color: #8b5cf6;
    }

    .logo a {
      color: inherit;
      text-decoration: none;
    }

    .nav-links {
      list-style: none;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .nav-links li {
      margin: 0;
    }

    .nav-links a {
      color: #fff;
      text-decoration: none;
      font-size: clamp(0.8rem, 2vw, 1rem);
      cursor: pointer;
      transition: all 0.3s;
      padding: 8px 12px;
      border-radius: 8px;
      white-space: nowrap;
    }

    .nav-links a:hover,
    .nav-links a:focus {
      color: #8b5cf6;
      background: rgba(139, 92, 246, 0.1);
    }

    .nav-links a[href="/games/"] {
      background: linear-gradient(45deg, #ec4899, #ffffff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: bold;
      padding: 8px 16px;
      border-radius: 20px;
      border: 2px solid transparent;
      background-origin: border-box;
      position: relative;
    }

    .nav-links a[href="/games/"]:before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, #ec4899, #ffffff);
      border-radius: 20px;
      z-index: -1;
      opacity: 0.1;
    }

    /* Particles */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }

    .particle {
      position: absolute;
      width: 3px;
      height: 3px;
      background: #a0a0e0;
      border-radius: 50%;
      animation: float 10s infinite;
      opacity: 0;
    }

    @keyframes float {
      0% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
      }

      10% {
        opacity: 0.8;
      }

      90% {
        opacity: 0.8;
      }

      100% {
        transform: translateY(-100px) rotate(360deg);
        opacity: 0;
      }
    }

    /* Game Container */
    .game-wrapper {
      position: relative;
      z-index: 10;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    .game-header {
      text-align: center;
    }

    .game-header h1 {
      font-size: clamp(1.5rem, 5vw, 2.5rem);
      background: linear-gradient(45deg, #8b5cf6, #06b6d4);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: glow 3s infinite alternate;
      margin-bottom: 8px;
    }

    @keyframes glow {
      from {
        filter: drop-shadow(0 0 10px rgba(139, 92, 246, 0.5));
      }

      to {
        filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.8));
      }
    }

    .game-header .instructions {
      color: #a0a0e0;
      font-size: 0.9rem;
    }

    /* Score Display */
    .score-display {
      display: flex;
      gap: 30px;
      font-size: 1.1rem;
    }

    .score-item {
      background: rgba(139, 92, 246, 0.15);
      border: 1px solid rgba(139, 92, 246, 0.3);
      padding: 10px 20px;
      border-radius: 25px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .score-item span {
      color: #8b5cf6;
      font-weight: bold;
    }

    /* Settings */
    .settings {
      display: flex;
      align-items: center;
      gap: 15px;
      background: rgba(139, 92, 246, 0.1);
      border: 1px solid rgba(139, 92, 246, 0.3);
      padding: 12px 20px;
      border-radius: 25px;
    }

    .settings label {
      color: #a0a0e0;
      font-size: 0.9rem;
      white-space: nowrap;
    }

    .settings input[type="range"] {
      -webkit-appearance: none;
      width: 120px;
      height: 6px;
      background: rgba(139, 92, 246, 0.3);
      border-radius: 3px;
      outline: none;
    }

    .settings input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      background: linear-gradient(45deg, #8b5cf6, #06b6d4);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
    }

    .settings input[type="range"]::-moz-range-thumb {
      width: 18px;
      height: 18px;
      background: linear-gradient(45deg, #8b5cf6, #06b6d4);
      border-radius: 50%;
      cursor: pointer;
      border: none;
    }

    .settings .value {
      color: #8b5cf6;
      font-weight: bold;
      min-width: 30px;
      text-align: center;
    }

    /* Combo Display */
    .combo-display {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 1.5rem;
      font-weight: bold;
      color: #fbbf24;
      text-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
      opacity: 0;
      transform: scale(0.5);
      transition: all 0.3s ease;
      z-index: 50;
    }

    .combo-display.active {
      opacity: 1;
      transform: scale(1);
    }

    /* Star Counter */
    .star-counter {
      background: linear-gradient(45deg, rgba(251, 191, 36, 0.2), rgba(251, 191, 36, 0.1));
      border: 1px solid rgba(251, 191, 36, 0.5);
      padding: 10px 20px;
      border-radius: 25px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1.1rem;
    }

    .star-counter span {
      color: #fbbf24;
      font-weight: bold;
    }

    /* Pause Button (Inline) */
    .pause-inline-btn {
      background: rgba(139, 92, 246, 0.2);
      border: 1px solid rgba(139, 92, 246, 0.5);
      color: #fff;
      font-size: 1rem;
      padding: 8px 15px;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .pause-inline-btn:hover {
      background: rgba(139, 92, 246, 0.4);
    }

    /* Show Rules Button (floating) */
    .show-rules-btn {
      position: fixed;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      width: 50px;
      height: 50px;
      background: rgba(139, 92, 246, 0.2);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(139, 92, 246, 0.5);
      color: #fff;
      font-size: 1.5rem;
      border-radius: 50%;
      cursor: pointer;
      z-index: 100;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      opacity: 0;
      pointer-events: none;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .show-rules-btn.visible {
      opacity: 1;
      pointer-events: auto;
    }

    .show-rules-btn:hover {
      background: rgba(139, 92, 246, 0.4);
      transform: translateY(-50%) scale(1.1);
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.4);
    }

    /* Gacha System */
    .shop-btn {
      background: linear-gradient(45deg, #f59e0b, #fbbf24);
      color: #000;
      font-weight: 800;
      border: none;
      padding: 8px 18px;
      border-radius: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
      transition: all 0.2s;
      text-transform: uppercase;
      font-size: 0.9rem;
    }

    .shop-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 20px rgba(245, 158, 11, 0.6);
    }

    .gacha-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
      padding: 10px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    /* Custom scrollbar for shop */
    .gacha-container::-webkit-scrollbar {
      width: 6px;
    }

    .gacha-container::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }

    .gacha-container::-webkit-scrollbar-thumb {
      background: rgba(139, 92, 246, 0.5);
      border-radius: 3px;
    }

    .gacha-card {
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.03) 100%);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 15px 10px;
      text-align: center;
      cursor: pointer;
      position: relative;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      backdrop-filter: blur(5px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    }

    .gacha-card:hover {
      transform: translateY(-5px);
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.08) 100%);
      border-color: rgba(139, 92, 246, 0.5);
      box-shadow: 0 10px 20px rgba(139, 92, 246, 0.2);
    }

    .gacha-card.locked {
      opacity: 0.6;
      filter: grayscale(0.8) brightness(0.7);
    }

    .gacha-card.selected {
      border: 2px solid #22c55e;
      background: linear-gradient(180deg, rgba(34, 197, 94, 0.15) 0%, rgba(34, 197, 94, 0.05) 100%);
      box-shadow: 0 0 25px rgba(34, 197, 94, 0.3);
      transform: scale(1.05);
    }

    .rarity-common {
      color: #94a3b8;
      font-weight: 600;
      font-size: 0.75rem;
      letter-spacing: 1px;
      margin-top: 5px;
    }

    .rarity-rare {
      color: #60a5fa;
      font-weight: 700;
      font-size: 0.75rem;
      letter-spacing: 1px;
      margin-top: 5px;
      text-shadow: 0 0 15px rgba(59, 130, 246, 0.4);
    }

    .rarity-legendary {
      color: #fbbf24;
      font-weight: 800;
      font-size: 0.75rem;
      letter-spacing: 1px;
      margin-top: 5px;
      text-shadow: 0 0 20px rgba(251, 191, 36, 0.7);
    }

    .pull-btn {
      background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 1.2rem;
      border-radius: 30px;
      cursor: pointer;
      font-weight: 800;
      width: 100%;
      margin-top: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
      transition: all 0.3s;
      text-transform: uppercase;
      letter-spacing: 1.5px;
    }

    .pull-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 40px rgba(139, 92, 246, 0.6);
      filter: brightness(1.1);
    }

    .pull-btn:active {
      transform: translateY(1px);
    }

    .pull-btn:disabled {
      filter: grayscale(1);
      cursor: not-allowed;
      opacity: 0.7;
      transform: none;
      box-shadow: none;
    }

    /* Pull Animation */
    .pull-anim-box {
      width: 80px;
      height: 80px;
      margin: 10px auto;
      background: #0f172a;
      border-radius: 10px;
      border: 2px solid #8b5cf6;
      border: 4px solid #8b5cf6;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      display: none;
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.2);
      transition: all 0.3s;
    }

    .pull-anim-box.rolling {
      display: flex;
      animation: shake 0.5s infinite, colorCycle 0.5s infinite;
    }

    .pull-anim-box.reveal {
      display: flex;
      animation: pop 0.4s ease-out;
      border-color: #fbbf24;
      box-shadow: 0 0 40px rgba(251, 191, 36, 0.5);
      transform: scale(1.1);
    }

    @keyframes colorCycle {
      0% {
        border-color: #8b5cf6;
        box-shadow: 0 0 20px rgba(139, 92, 246, 0.5);
      }

      33% {
        border-color: #3b82f6;
        box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
      }

      66% {
        border-color: #fbbf24;
        box-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
      }

      100% {
        border-color: #ec4899;
        box-shadow: 0 0 20px rgba(236, 72, 153, 0.5);
      }
    }

    @keyframes pop {
      0% {
        transform: scale(0.5);
        opacity: 0;
      }

      70% {
        transform: scale(1.2);
      }

      100% {
        transform: scale(1.1);
        opacity: 1;
      }
    }

    @keyframes shake {
      0% {
        transform: rotate(0deg);
      }

      25% {
        transform: rotate(10deg);
      }

      50% {
        transform: rotate(0deg);
      }

      75% {
        transform: rotate(-10deg);
      }

      100% {
        transform: rotate(0deg);
      }
    }

    /* Rules Panel */
    .rules-panel {
      background: rgba(139, 92, 246, 0.1);
      border: 1px solid rgba(139, 92, 246, 0.3);
      border-radius: 15px;
      max-width: 200px;
      margin-left: 20px;
      overflow: hidden;
    }

    .rules-toggle {
      width: 100%;
      background: rgba(139, 92, 246, 0.2);
      border: none;
      color: #8b5cf6;
      font-size: 1rem;
      font-weight: bold;
      padding: 15px 20px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background 0.3s;
    }

    .rules-toggle:hover {
      background: rgba(139, 92, 246, 0.3);
    }

    .rules-toggle .arrow {
      transition: transform 0.3s;
    }

    .rules-panel.collapsed .arrow {
      transform: rotate(90deg);
    }

    .rules-panel.collapsed {
      max-width: 0;
      padding: 0;
      border: none;
      margin: 0;
      opacity: 0;
    }

    .rules-content {
      padding: 15px 20px;
      max-height: 400px;
      transition: max-height 0.3s ease, padding 0.3s ease;
    }

    .rules-panel.collapsed .rules-content {
      max-height: 0;
      padding: 0;
      overflow: hidden;
    }

    .rules-panel ul {
      list-style: none;
      font-size: 0.85rem;
      color: #a0a0e0;
    }

    .rules-panel li {
      margin-bottom: 10px;
      padding-left: 20px;
      position: relative;
    }

    .rules-panel li::before {
      content: '‚ú¶';
      position: absolute;
      left: 0;
      color: #8b5cf6;
    }

    /* Game Layout */
    .game-main {
      display: flex;
      align-items: flex-start;
      gap: 20px;
    }

    .game-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    @media (max-width: 700px) {
      .rules-panel {
        display: none;
      }
    }

    /* Canvas */
    #gameCanvas {
      border: 2px solid rgba(139, 92, 246, 0.5);
      border-radius: 15px;
      box-shadow: 0 0 40px rgba(139, 92, 246, 0.3);
      background: linear-gradient(180deg, #0a0a1a 0%, #0f2847 100%);
    }

    /* Overlay Screens */
    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 10, 26, 0.95);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 25px;
      border-radius: 15px;
      z-index: 100;
      backdrop-filter: blur(5px);
    }

    .overlay.hidden {
      display: none;
    }

    .overlay h2 {
      font-size: 2.5rem;
      background: linear-gradient(45deg, #ec4899, #8b5cf6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .overlay p {
      color: #a0a0e0;
      font-size: 1.1rem;
      text-align: center;
      max-width: 280px;
    }

    .overlay .final-score {
      font-size: 1.5rem;
      color: #fff;
    }

    .overlay .final-score span {
      color: #06b6d4;
      font-weight: bold;
      font-size: 2rem;
    }

    .start-btn {
      background: linear-gradient(45deg, #8b5cf6, #06b6d4);
      border: none;
      color: #fff;
      font-size: 1.2rem;
      font-weight: bold;
      padding: 15px 45px;
      border-radius: 30px;
      cursor: pointer;
      transition: all 0.3s;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .start-btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 10px 30px rgba(139, 92, 246, 0.5);
    }



    /* Mobile Controls */
    .mobile-controls {
      display: none;
      gap: 20px;
      margin-top: 15px;
    }

    .mobile-btn {
      background: rgba(139, 92, 246, 0.2);
      border: 2px solid rgba(139, 92, 246, 0.5);
      color: #fff;
      font-size: 2rem;
      width: 80px;
      height: 60px;
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .mobile-btn:active {
      background: rgba(139, 92, 246, 0.5);
      transform: scale(0.95);
    }

    @media (max-width: 600px) {
      .mobile-controls {
        display: flex;
      }

      .game-header .instructions {
        display: none;
      }
    }

    @media (pointer: coarse) {
      .mobile-controls {
        display: flex;
      }
    }
  </style>
</head>

<body>
  <div class="particles"></div>
  <div id="nav" style="width: 100%;"></div>
  <script>
    fetch("/navbar.html")
      .then(r => r.text())
      .then(t => document.getElementById("nav").innerHTML = t);
  </script>

  <div class="game-wrapper">
    <div class="game-header">
      <h1>üöÄ Stellar Jump</h1>
      <p class="instructions">Use ‚Üê ‚Üí arrow keys or A/D to move</p>
    </div>

    <div class="score-display">
      <div class="score-item">üéØ Score: <span id="score">0</span></div>
      <div class="score-item">üèÜ Best: <span id="highScore">0</span></div>
      <div class="star-counter">‚≠ê Stars: <span id="totalStars">0</span></div>
    </div>

    <div class="settings">
      <label>üéÆ Sensitivity:</label>
      <input type="range" id="sensitivity" min="1" max="10" value="5">
      <span class="value" id="sensitivityValue">5</span>
      <div style="width: 1px; height: 20px; background: rgba(139, 92, 246, 0.3); margin: 0 10px;"></div>
      <button class="pause-inline-btn" id="pauseBtn">‚è∏Ô∏è Pause</button>
      <div style="width: 1px; height: 20px; background: rgba(139, 92, 246, 0.3); margin: 0 10px;"></div>
      <button class="shop-btn" id="openShopBtn">üõçÔ∏è Shop</button>
    </div>

    <div class="game-main">
      <div class="game-area">

        <div style="position: relative;">
          <canvas id="gameCanvas" width="400" height="600"></canvas>

          <!-- Start Screen -->
          <div class="overlay" id="startScreen">
            <h2>üöÄ Stellar Jump</h2>
            <p>Jump through the cosmos! Land on platforms and climb as high as you can.</p>
            <button class="start-btn" id="startBtn">Start Game</button>
          </div>

          <!-- Game Over Screen -->
          <div class="overlay hidden" id="gameOverScreen">
            <h2>üí´ Game Over</h2>
            <div class="final-score">Score: <span id="finalScore">0</span></div>
            <button class="start-btn" id="restartBtn">Play Again</button>
          </div>

          <!-- Pause Screen -->
          <div class="overlay hidden" id="pauseScreen">
            <h2>‚è∏Ô∏è Paused</h2>
            <p>Press P or click Resume to continue</p>
            <button class="start-btn" id="resumeBtn">Resume</button>
          </div>

          <!-- Shop Screen -->
          <div class="overlay hidden" id="shopScreen"
            style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(10, 10, 26, 0.9); backdrop-filter: blur(20px); z-index: 1000; justify-content: center; align-items: center; padding: 20px;">
            <div
              style="background: rgba(15, 23, 42, 0.9); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 20px; width: 100%; max-width: 600px; padding: 30px; display: flex; flex-direction: column; gap: 20px; max-height: 95vh; overflow-y: auto;">
              <div style="width: 100%; display: flex; justify-content: space-between; align-items: center;">
                <h2 style="font-size: 2rem; margin: 0; text-shadow: 0 0 20px rgba(236, 72, 153, 0.5);">üõçÔ∏è Skin Shop
                </h2>
                <button class="pause-inline-btn" id="closeShopBtn"
                  style="background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.2);">‚ùå Close</button>
              </div>

              <div style="color: #fbbf24; font-weight: bold; font-size: 1.2rem; text-align: center;">
                Stars: <span id="shopStars">0</span> ‚≠ê
              </div>

              <div class="gacha-container" id="skinGrid">
                <!-- Skins injected via JS -->
              </div>

              <div style="text-align: center;">
                <div class="pull-anim-box" id="pullBox">üì¶</div>
                <button class="pull-btn" id="pullBtn">
                  <span>üé≤ 50 Stars</span>
                </button>
                <p id="pullMessage" style="height: 20px; margin-top: 10px; color: #a0a0e0; font-size: 0.9rem;"></p>
              </div>
            </div>
          </div>

          <!-- Star Collect Display -->
          <div class="combo-display" id="starCollect">‚≠ê +1</div>
        </div>

        <div class="mobile-controls">
          <button class="mobile-btn" id="leftBtn">‚óÄ</button>
          <button class="mobile-btn" id="rightBtn">‚ñ∂</button>
        </div>
      </div>

      <div class="rules-panel" id="rulesPanel">
        <button class="rules-toggle" id="rulesToggle">
          üìú How to Play <span class="arrow">‚ñº</span>
        </button>
        <div class="rules-content">
          <ul>
            <li>Use ‚Üê ‚Üí or A/D to move</li>
            <li>Land on platforms to jump</li>
            <li>Collect ‚≠ê stars as currency!</li>
            <li>üü¢ Green = Super jump</li>
            <li>üü£ Pink = Moving platform</li>
            <li>üî¥ Red = Breaks after one use</li>
            <li>Press P to pause</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Floating Show Rules Button -->
    <button class="show-rules-btn" id="showRulesBtn">‚óÄ</button>

    <script>
      // Particles
      const particleContainer = document.querySelector('.particles');
      for (let i = 0; i < 60; i++) {
        const p = document.createElement('div');
        p.className = 'particle';
        p.style.left = Math.random() * 100 + 'vw';
        p.style.animationDuration = Math.random() * 10 + 5 + 's';
        p.style.animationDelay = Math.random() * 20 + 's';
        particleContainer.appendChild(p);
      }

      // Game Setup
      const canvas = document.getElementById('gameCanvas');
      const ctx = canvas.getContext('2d');
      const scoreEl = document.getElementById('score');
      const highScoreEl = document.getElementById('highScore');
      const startScreen = document.getElementById('startScreen');
      const gameOverScreen = document.getElementById('gameOverScreen');
      const finalScoreEl = document.getElementById('finalScore');

      // Load high score
      let highScore = parseInt(localStorage.getItem('stellarJumpHighScore')) || 0;
      highScoreEl.textContent = highScore;

      // Game Constants
      const GRAVITY = 0.235
      const JUMP_FORCE = -11
      const PLATFORM_WIDTH = 85;
      const PLATFORM_HEIGHT = 15;
      const PLAYER_WIDTH = 35;
      const PLAYER_HEIGHT = 35;

      // Sensitivity (1-10 scale, default 5)
      let sensitivity = 5;
      const sensitivitySlider = document.getElementById('sensitivity');
      const sensitivityValue = document.getElementById('sensitivityValue');

      sensitivitySlider.addEventListener('input', (e) => {
        sensitivity = parseInt(e.target.value);
        sensitivityValue.textContent = sensitivity;
      });

      // Game State
      let player, platforms, stars, score, gameRunning, cameraY;
      let keys = { left: false, right: false };
      let isPaused = false;
      let starsCollected = 0;
      let trailParticles = [];
      let screenFlash = 0;

      // Load total stars from localStorage (site currency)
      let totalStars = parseInt(localStorage.getItem('iamdrcat_stars')) || 0;
      const totalStarsEl = document.getElementById('totalStars');
      totalStarsEl.textContent = totalStars;

      const pauseScreen = document.getElementById('pauseScreen');
      const starCollectDisplay = document.getElementById('starCollect');

      // Rules toggle
      const rulesPanel = document.getElementById('rulesPanel');
      const showRulesBtn = document.getElementById('showRulesBtn');

      function toggleRules() {
        rulesPanel.classList.toggle('collapsed');
        const isCollapsed = rulesPanel.classList.contains('collapsed');
        showRulesBtn.classList.toggle('visible', isCollapsed);
      }

      document.getElementById('rulesToggle').addEventListener('click', toggleRules);
      showRulesBtn.addEventListener('click', toggleRules);

      // Skins System
      const SKINS = [
        { id: 'default', name: 'Standard', rarity: 'common', color1: '#8b5cf6', color2: '#06b6d4' },
        { id: 'ruby', name: 'Ruby', rarity: 'common', color1: '#ef4444', color2: '#b91c1c' },
        { id: 'emerald', name: 'Emerald', rarity: 'common', color1: '#10b981', color2: '#047857' },
        { id: 'golden', name: 'Golden', rarity: 'rare', color1: '#f59e0b', color2: '#fbbf24' },
        { id: 'neon', name: 'Neon', rarity: 'rare', color1: '#d946ef', color2: '#8b5cf6' },
        { id: 'plasma', name: 'Plasma', rarity: 'rare', color1: '#3b82f6', color2: '#6366f1' },
        { id: 'void', name: 'Void', rarity: 'legendary', color1: '#1e293b', color2: '#000000' },
        { id: 'starlight', name: 'Starlight', rarity: 'legendary', color1: '#ffffff', color2: '#e2e8f0' }
      ];

      // Load skins state
      let unlockedSkins = JSON.parse(localStorage.getItem('iamdrcat_skins')) || ['default'];
      let currentSkinId = localStorage.getItem('iamdrcat_current_skin') || 'default';
      let currentSkin = SKINS.find(s => s.id === currentSkinId) || SKINS[0];

      // Shop Elements
      const shopScreen = document.getElementById('shopScreen');
      const skinGrid = document.getElementById('skinGrid');
      const shopStarsEl = document.getElementById('shopStars');
      const pullBtn = document.getElementById('pullBtn');
      const pullBox = document.getElementById('pullBox');
      const pullMessage = document.getElementById('pullMessage');

      function updateShopUI() {
        shopStarsEl.textContent = totalStars;
        pullBtn.disabled = totalStars < 50;

        skinGrid.innerHTML = '';
        SKINS.forEach(skin => {
          const isUnlocked = unlockedSkins.includes(skin.id);
          const isSelected = currentSkinId === skin.id;

          const card = document.createElement('div');
          card.className = `gacha-card ${isUnlocked ? '' : 'locked'} ${isSelected ? 'selected' : ''}`;
          card.innerHTML = `
            <div style="width: 30px; height: 30px; background: linear-gradient(135deg, ${skin.color1}, ${skin.color2}); border-radius: 50%; margin: 0 auto 10px;"></div>
            <div style="font-weight: bold; font-size: 0.9rem;">${skin.name}</div>
            <div class="rarity-${skin.rarity}" style="font-size: 0.8rem; text-transform: uppercase;">${skin.rarity}</div>
            ${isUnlocked ? '' : '<div style="margin-top: 5px; font-size: 1.2rem;">üîí</div>'}
          `;

          if (isUnlocked) {
            card.onclick = () => {
              currentSkinId = skin.id;
              currentSkin = skin;
              localStorage.setItem('iamdrcat_current_skin', currentSkinId);
              updateShopUI();
            };
          }

          skinGrid.appendChild(card);
        });
      }

      // Open/Close Shop
      document.getElementById('openShopBtn').addEventListener('click', () => {
        isPaused = true;
        updateShopUI();
        shopScreen.classList.remove('hidden');
      });

      document.getElementById('closeShopBtn').addEventListener('click', () => {
        shopScreen.classList.add('hidden');
        if (gameRunning) isPaused = false;
      });

      // Gacha Pull Logic
      pullBtn.addEventListener('click', () => {
        if (totalStars < 50) return;

        // Deduct stars
        totalStars -= 50;
        localStorage.setItem('iamdrcat_stars', totalStars);
        updateShopUI(); // Update stars immediately

        // Animation
        pullBtn.disabled = true;
        pullBox.classList.remove('reveal');
        pullBox.classList.add('rolling');
        pullMessage.textContent = "Rolling...";
        pullMessage.style.color = '#fff';

        // Cycle colors during roll
        let rollInterval = setInterval(() => {
          const colors = SKINS.map(s => s.color1);
          pullBox.style.borderColor = colors[Math.floor(Math.random() * colors.length)];
        }, 100);

        setTimeout(() => {
          clearInterval(rollInterval);
          pullBox.classList.remove('rolling');
          pullBox.classList.add('reveal');
          pullBox.style.borderColor = ''; // Reset inline style

          // Probability: Common 60%, Rare 30%, Legendary 10%
          const rand = Math.random();
          let rarity = 'common';
          if (rand > 0.9) rarity = 'legendary';
          else if (rand > 0.6) rarity = 'rare';

          const pool = SKINS.filter(s => s.rarity === rarity && s.id !== 'default');
          const wonSkin = pool[Math.floor(Math.random() * pool.length)];

          // Visual reveal
          pullBox.innerHTML = `<div style="width: 40px; height: 40px; background: linear-gradient(135deg, ${wonSkin.color1}, ${wonSkin.color2}); border-radius: 50%;"></div>`;

          const isNew = !unlockedSkins.includes(wonSkin.id);
          if (isNew) {
            unlockedSkins.push(wonSkin.id);
            localStorage.setItem('iamdrcat_skins', JSON.stringify(unlockedSkins));
            pullMessage.textContent = `‚ú® NEW! ${wonSkin.name}!`;
            pullMessage.style.color = getRarityColor(rarity);
          } else {
            totalStars += 10;
            localStorage.setItem('iamdrcat_stars', totalStars);
            pullMessage.innerHTML = `${wonSkin.name} <span style="font-size:0.8em; color:#a0a0e0;">(Duplicate +10‚≠ê)</span>`;
            pullMessage.style.color = getRarityColor(rarity);
          }

          updateShopUI();
          pullBtn.disabled = false;
        }, 2000);
      });

      function getRarityColor(rarity) {
        if (rarity === 'legendary') return '#fbbf24';
        if (rarity === 'rare') return '#3b82f6';
        return '#a0a0e0';
      }

      // Player Class
      class Player {
        constructor() {
          this.width = PLAYER_WIDTH;
          this.height = PLAYER_HEIGHT;
          this.x = canvas.width / 2 - this.width / 2;
          this.y = canvas.height - 100;
          this.vx = 0;
          this.vy = 0;
          this.onPlatform = false;
        }

        update() {
          // Horizontal movement (speed based on sensitivity: 3-9 range)
          const moveSpeed = 3 + (sensitivity - 1) * 0.75;
          if (keys.left) this.vx = -moveSpeed;
          else if (keys.right) this.vx = moveSpeed;
          else this.vx *= 0.85;

          this.x += this.vx;

          // Wrap around screen
          if (this.x + this.width < 0) this.x = canvas.width;
          if (this.x > canvas.width) this.x = -this.width;

          // Apply gravity
          this.vy += GRAVITY;
          this.y += this.vy;

          this.onPlatform = false;
        }

        draw() {
          const screenY = this.y - cameraY;

          // Rocket body gradient
          const gradient = ctx.createLinearGradient(this.x, screenY, this.x + this.width, screenY + this.height);
          gradient.addColorStop(0, currentSkin.color1);
          gradient.addColorStop(1, currentSkin.color2);

          // Draw rocket
          ctx.save();
          ctx.translate(this.x + this.width / 2, screenY + this.height / 2);

          // Body
          ctx.fillStyle = gradient;
          ctx.beginPath();
          ctx.moveTo(0, -this.height / 2);
          ctx.lineTo(this.width / 2 - 5, this.height / 3);
          ctx.lineTo(this.width / 2 - 5, this.height / 2);
          ctx.lineTo(-this.width / 2 + 5, this.height / 2);
          ctx.lineTo(-this.width / 2 + 5, this.height / 3);
          ctx.closePath();
          ctx.fill();

          // Window
          ctx.fillStyle = '#fff';
          ctx.beginPath();
          ctx.arc(0, -3, 6, 0, Math.PI * 2);
          ctx.fill();
          ctx.fillStyle = currentSkin.color2;
          ctx.beginPath();
          ctx.arc(0, -3, 4, 0, Math.PI * 2);
          ctx.fill();

          // Flame when jumping
          if (this.vy < 0) {
            ctx.fillStyle = '#f97316';
            ctx.beginPath();
            ctx.moveTo(-8, this.height / 2);
            ctx.lineTo(0, this.height / 2 + 15 + Math.random() * 8);
            ctx.lineTo(8, this.height / 2);
            ctx.closePath();
            ctx.fill();

            ctx.fillStyle = '#fbbf24';
            ctx.beginPath();
            ctx.moveTo(-4, this.height / 2);
            ctx.lineTo(0, this.height / 2 + 10 + Math.random() * 5);
            ctx.lineTo(4, this.height / 2);
            ctx.closePath();
            ctx.fill();
          }

          ctx.restore();
        }

        jump() {
          this.vy = JUMP_FORCE;
        }
      }

      // Platform Class
      class Platform {
        constructor(x, y, type = 'normal') {
          this.x = x;
          this.y = y;
          this.width = PLATFORM_WIDTH;
          this.height = PLATFORM_HEIGHT;
          this.type = type;
          this.vx = type === 'moving' ? (Math.random() > 0.5 ? 2 : -2) : 0;
          this.broken = false;
          this.opacity = 1;
        }

        update() {
          if (this.type === 'moving') {
            this.x += this.vx;
            if (this.x <= 0 || this.x + this.width >= canvas.width) {
              this.vx *= -1;
            }
          }
          if (this.broken) {
            this.opacity -= 0.1;
          }
        }

        draw() {
          const screenY = this.y - cameraY;
          if (screenY < -50 || screenY > canvas.height + 50) return;

          ctx.save();
          ctx.globalAlpha = this.opacity;

          // Platform colors based on type
          let color1, color2;
          switch (this.type) {
            case 'moving':
              color1 = '#ec4899';
              color2 = '#8b5cf6';
              break;
            case 'fragile':
              color1 = '#ef4444';
              color2 = '#dc2626';
              break;
            case 'boost':
              color1 = '#22c55e';
              color2 = '#16a34a';
              break;
            default:
              color1 = '#8b5cf6';
              color2 = '#6366f1';
          }

          // Glow effect
          ctx.shadowColor = color1;
          ctx.shadowBlur = 15;
          ctx.shadowOffsetY = 2;

          // Platform gradient
          const gradient = ctx.createLinearGradient(this.x, screenY, this.x, screenY + this.height);
          gradient.addColorStop(0, color1);
          gradient.addColorStop(1, color2);

          ctx.fillStyle = gradient;
          ctx.beginPath();
          ctx.roundRect(this.x, screenY, this.width, this.height, 8);
          ctx.fill();

          // Highlight
          ctx.fillStyle = 'rgba(255,255,255,0.3)';
          ctx.beginPath();
          ctx.roundRect(this.x + 5, screenY + 2, this.width - 10, 4, 2);
          ctx.fill();

          ctx.restore();
        }
      }

      // Star Class
      class Star {
        constructor(x, y) {
          this.x = x;
          this.y = y;
          this.size = 12;
          this.collected = false;
          this.rotation = Math.random() * Math.PI * 2;
          this.rotationSpeed = 0.05;
        }

        update() {
          this.rotation += this.rotationSpeed;
        }

        draw() {
          if (this.collected) return;
          const screenY = this.y - cameraY;
          if (screenY < -50 || screenY > canvas.height + 50) return;

          ctx.save();
          ctx.translate(this.x, screenY);
          ctx.rotate(this.rotation);

          // Glow
          ctx.shadowColor = '#fbbf24';
          ctx.shadowBlur = 20;

          // Star shape
          ctx.fillStyle = '#fbbf24';
          ctx.beginPath();
          for (let i = 0; i < 5; i++) {
            const angle = (i * 4 * Math.PI) / 5 - Math.PI / 2;
            const r = i === 0 ? this.size : this.size;
            ctx.lineTo(Math.cos(angle) * r, Math.sin(angle) * r);
            const innerAngle = angle + (2 * Math.PI) / 10;
            ctx.lineTo(Math.cos(innerAngle) * (this.size / 2), Math.sin(innerAngle) * (this.size / 2));
          }
          ctx.closePath();
          ctx.fill();

          ctx.restore();
        }
      }

      // Initialize Game
      function initGame() {
        player = new Player();
        platforms = [];
        stars = [];
        score = 0;
        cameraY = 0;
        gameRunning = true;

        scoreEl.textContent = '0';

        // Create initial platforms
        platforms.push(new Platform(canvas.width / 2 - PLATFORM_WIDTH / 2, canvas.height - 50, 'normal'));

        for (let i = 0; i < 10; i++) {
          createPlatform(canvas.height - 100 - i * 180);
        }
      }

      function createPlatform(baseY) {
        const x = Math.random() * (canvas.width - PLATFORM_WIDTH);
        const y = baseY + (Math.random() * 30 - 15);

        // Platform type probability
        const rand = Math.random();
        let type = 'normal';
        if (score > 500 && rand < 0.15) type = 'moving';
        else if (score > 300 && rand < 0.1) type = 'fragile';
        else if (score > 200 && rand < 0.08) type = 'boost';

        platforms.push(new Platform(x, y, type));

        // Maybe add a star
        if (Math.random() < 0.3) {
          stars.push(new Star(x + PLATFORM_WIDTH / 2, y - 30));
        }
      }

      // Trail Particle Class
      class TrailParticle {
        constructor(x, y) {
          this.x = x;
          this.y = y;
          this.size = Math.random() * 4 + 2;
          this.life = 1;
          this.decay = 0.03 + Math.random() * 0.02;
          this.vx = (Math.random() - 0.5) * 2;
          this.vy = Math.random() * 2;
          this.color = Math.random() > 0.5 ? '#8b5cf6' : '#06b6d4';
        }

        update() {
          this.life -= this.decay;
          this.x += this.vx;
          this.y += this.vy;
        }

        draw() {
          const screenY = this.y - cameraY;
          ctx.save();
          ctx.globalAlpha = this.life;
          ctx.fillStyle = this.color;
          ctx.shadowColor = this.color;
          ctx.shadowBlur = 10;
          ctx.beginPath();
          ctx.arc(this.x, screenY, this.size * this.life, 0, Math.PI * 2);
          ctx.fill();
          ctx.restore();
        }
      }

      // Game Loop
      function gameLoop() {
        if (!gameRunning) return;
        if (isPaused) {
          requestAnimationFrame(gameLoop);
          return;
        }

        update();
        draw();
        requestAnimationFrame(gameLoop);
      }

      function update() {
        player.update();

        // Add trail particles when jumping
        if (player.vy < 0) {
          trailParticles.push(new TrailParticle(
            player.x + player.width / 2 + (Math.random() - 0.5) * 10,
            player.y + player.height
          ));
        }

        // Update trail particles
        trailParticles.forEach(p => p.update());
        trailParticles = trailParticles.filter(p => p.life > 0);

        // Update screen flash
        if (screenFlash > 0) screenFlash -= 0.05;

        // Check platform collisions
        if (player.vy > 0) {
          for (const plat of platforms) {
            if (
              player.x + player.width > plat.x &&
              player.x < plat.x + plat.width &&
              player.y + player.height > plat.y &&
              player.y + player.height < plat.y + plat.height + player.vy + 5
            ) {
              if (plat.type === 'fragile') {
                plat.broken = true;
                player.jump();
              } else if (plat.type === 'boost') {
                player.vy = JUMP_FORCE * 1.5;
              } else {
                player.jump();
              }
              player.onPlatform = true;
              break;
            }
          }
        }

        // Update platforms
        platforms.forEach(p => p.update());
        platforms = platforms.filter(p => p.opacity > 0);

        // Update stars and check collection
        for (const star of stars) {
          star.update();
          if (!star.collected) {
            const dx = player.x + player.width / 2 - star.x;
            const dy = player.y + player.height / 2 - star.y;
            if (Math.sqrt(dx * dx + dy * dy) < 35) {
              star.collected = true;
              starsCollected++;
              totalStars++;
              localStorage.setItem('iamdrcat_stars', totalStars);
              totalStarsEl.textContent = totalStars;
              score += 50;
              scoreEl.textContent = score;

              // Show star collect animation
              starCollectDisplay.textContent = `‚≠ê +1`;
              starCollectDisplay.classList.add('active');
              setTimeout(() => starCollectDisplay.classList.remove('active'), 500);
            }
          }
        }

        // Camera follows player
        const targetCameraY = player.y - canvas.height * 0.4;
        if (targetCameraY < cameraY) {
          cameraY = targetCameraY;
          score = Math.max(score, Math.floor(-cameraY / 10));
          scoreEl.textContent = score;
        }

        // Generate new platforms above
        let topPlatformY = platforms.length > 0 ? Math.min(...platforms.map(p => p.y)) : cameraY;
        let safetyCounter = 0;
        while (topPlatformY > cameraY - 100 && safetyCounter < 10) {
          const newY = topPlatformY - 150 - Math.random() * 75;
          createPlatform(newY);
          topPlatformY = newY;
          safetyCounter++;
        }

        // Remove platforms below screen
        platforms = platforms.filter(p => p.y < cameraY + canvas.height + 100);
        stars = stars.filter(s => s.y < cameraY + canvas.height + 100);

        // Game over if player falls
        if (player.y > cameraY + canvas.height + 100) {
          endGame();
        }
      }

      function draw() {
        // Clear canvas
        ctx.fillStyle = 'rgba(10, 10, 26, 1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Draw distant stars background
        drawBackground();

        // Draw trail particles
        trailParticles.forEach(p => p.draw());

        // Draw platforms
        platforms.forEach(p => p.draw());

        // Draw stars
        stars.forEach(s => s.draw());

        // Draw player
        player.draw();


      }

      function drawBackground() {
        // Static background stars
        ctx.fillStyle = 'rgba(255,255,255,0.5)';
        const seed = 12345;
        for (let i = 0; i < 50; i++) {
          const x = (Math.sin(i * seed) * 10000) % canvas.width;
          const y = ((i * 37 - cameraY * 0.1) % canvas.height + canvas.height) % canvas.height;
          const size = (i % 3) + 1;
          ctx.beginPath();
          ctx.arc(x, y, size, 0, Math.PI * 2);
          ctx.fill();
        }
      }

      function endGame() {
        gameRunning = false;

        // Update high score
        if (score > highScore) {
          highScore = score;
          localStorage.setItem('stellarJumpHighScore', highScore);
          highScoreEl.textContent = highScore;
        }

        finalScoreEl.textContent = score;
        gameOverScreen.classList.remove('hidden');
      }

      // Pause functions
      function togglePause() {
        if (!gameRunning) return;
        isPaused = !isPaused;
        pauseScreen.classList.toggle('hidden', !isPaused);
      }

      document.getElementById('pauseBtn').addEventListener('click', togglePause);
      document.getElementById('resumeBtn').addEventListener('click', togglePause);

      // Input Handling
      document.addEventListener('keydown', e => {
        if (e.key.toLowerCase() === 'p') togglePause();
        if (e.key === 'ArrowLeft' || e.key.toLowerCase() === 'a') keys.left = true;
        if (e.key === 'ArrowRight' || e.key.toLowerCase() === 'd') keys.right = true;
      });

      document.addEventListener('keyup', e => {
        if (e.key === 'ArrowLeft' || e.key.toLowerCase() === 'a') keys.left = false;
        if (e.key === 'ArrowRight' || e.key.toLowerCase() === 'd') keys.right = false;
      });

      // Mobile controls
      const leftBtn = document.getElementById('leftBtn');
      const rightBtn = document.getElementById('rightBtn');

      leftBtn.addEventListener('touchstart', e => { e.preventDefault(); keys.left = true; });
      leftBtn.addEventListener('touchend', e => { e.preventDefault(); keys.left = false; });
      rightBtn.addEventListener('touchstart', e => { e.preventDefault(); keys.right = true; });
      rightBtn.addEventListener('touchend', e => { e.preventDefault(); keys.right = false; });

      // Button listeners
      document.getElementById('startBtn').addEventListener('click', () => {
        startScreen.classList.add('hidden');
        initGame();
        gameLoop();
      });

      document.getElementById('restartBtn').addEventListener('click', () => {
        gameOverScreen.classList.add('hidden');
        initGame();
        gameLoop();
      });
    </script>
</body>

</html>